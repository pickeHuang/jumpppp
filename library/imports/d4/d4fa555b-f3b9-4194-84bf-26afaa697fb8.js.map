{"version":3,"sources":["../../../../../assets/Script/Game/assets/Script/Game/PlatformSpawner.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/Script/Game","sourcesContent":["\nconst { ccclass, property } = cc._decorator;\n\nconst enum path {\n    floor = \"Prefabs/Platform/floor\",\n    character = \"Prefabs/Character/characters_3\"\n}\n\n@ccclass\nexport default class PlatformSpawn extends cc.Component {\n\n\n    /**地板的prefab */\n    private floorPre: cc.Node;\n    /** 初始位置*/\n    private spawnPos: cc.Vec2;\n    /**生成个数 */\n    private spawnCount: number = 4;\n    /**是否生成在左边 */\n    private isleftspawn: boolean;\n    private touchnode: cc.Node;\n    private character: cc.Node;\n\n\n\n    onLoad() {\n\n        this.touchnode = cc.find(\"Canvas/TouchNode\");\n        this.touchnode.on(cc.Node.EventType.TOUCH_START, this.DecidePath, this);\n        this.isleftspawn = false;\n        this.spawnPos = new cc.Vec2(0, -200);\n\n    }\n\n    start() {\n        this.startInit();\n        // cc.loader.loadRes('Prefabs/Platform/floor', (err, prefab) => {\n        //     if (err) {\n\n        //         console.log(err);\n\n        //     } else {\n\n        //         this.floorPre = cc.instantiate(prefab);\n        //         this.node.addChild(this.floorPre);\n        //         this.SpwanFloor();\n        //     }\n        //     for (let i = 0; i < this.spawnCount; i++) {\n        //         this.spawnCount = 4;\n        //         this.DecidePath();\n        //     }\n        // });\n\n        // cc.loader.loadRes('Prefabs/Character/characters_3', (err, prefab) => {\n        //     if (err) {\n\n        //         console.log(err);\n\n        //     } else {\n\n        //         this.character = cc.instantiate(prefab);\n        //         this.node.addChild(this.character);\n        //         this.character.setPosition(this.floorPre.getPosition().x,this.floorPre.getPosition().y+60);\n\n        //     }\n        // });\n    }\n\n    private  startInit() {\n\n        this.createFloor();\n        this.createCharacter();\n       \n    }\n\n    private async createFloor(): Promise<void> {\n        let floorp = await this.loadPrefab(path.floor);\n        this.floorPre = cc.instantiate(floorp.prefab);\n        this.node.addChild(this.floorPre);\n        this.SpwanFloor();\n        for (let i = 0; i < this.spawnCount; i++) {\n            this.spawnCount = 4;\n            this.DecidePath();\n        }\n    }\n\n    private async createCharacter(): Promise<void> {\n        let charcterp = await this.loadPrefab(path.character);\n        this.character = cc.instantiate(charcterp.prefab);\n        this.node.addChild(this.character);\n        this.character.setPosition(this.floorPre.getPosition().x, this.floorPre.getPosition().y + 60);\n    }\n\n    /**确定生成路径 */\n    public DecidePath(event?: any): void {\n\n        if (this.spawnCount > 0) {\n            this.spawnCount--;\n            //生成方法\n            this.SpwanFloor();\n        } else {\n            this.isleftspawn = !this.isleftspawn;\n            this.spawnCount = 3;\n            this.SpwanFloor();\n\n        }\n    }\n\n    /**实例化地板并且计算下一块的位置 */\n    private SpwanFloor(): void {\n\n        let floorobj = cc.instantiate(this.floorPre);\n        this.node.addChild(floorobj);\n        floorobj.setPosition(this.spawnPos);\n\n        if (this.isleftspawn) {\n\n            this.spawnPos = new cc.Vec2(this.spawnPos.x - 65, this.spawnPos.y + 70);\n        }\n        else {\n            this.spawnPos = new cc.Vec2(this.spawnPos.x + 65, this.spawnPos.y + 70);\n        }\n    }\n\n    /**\n     * 动态加载预制体\n     * @param _file 路径\n     */\n    public async loadPrefab(_file: string): Promise<{ prefab: cc.Prefab }> {\n        return new Promise((reslove) => {\n            cc.loader.loadRes(_file, (error: Error, resource: any) => {\n                if (error) {\n                    console.error(\"资源加载错误：\", error);\n                    reslove({ prefab: null })\n                } else {\n                    reslove({ prefab: resource });\n                }\n            })\n        })\n\n    }\n\n    onDestroy() {\n\n        this.touchnode.on(cc.Node.EventType.TOUCH_START, this.DecidePath, this);\n\n    }\n\n\n\n}\n"]}